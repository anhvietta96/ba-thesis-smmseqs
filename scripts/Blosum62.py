# use like this:
#   from Blosum62 import Blosum62Matrix
#   m = Blosum62Matrix()
#   s = m.getscore('L','K')

import operator

class Blosum62Matrix:
  def __init__(self):
    self.alpha = "LVIFKREDAGSTNQYWPHMCX"
    self.scorematrix = dict()
    for aa in self.alpha:
      self.scorematrix[aa] = dict()
    self.scorematrix['L']['L'] = 4
    self.scorematrix['L']['V'] = 1
    self.scorematrix['L']['I'] = 2
    self.scorematrix['L']['F'] = 0
    self.scorematrix['L']['K'] = -2
    self.scorematrix['L']['R'] = -2
    self.scorematrix['L']['E'] = -3
    self.scorematrix['L']['D'] = -4
    self.scorematrix['L']['A'] = -1
    self.scorematrix['L']['G'] = -4
    self.scorematrix['L']['S'] = -2
    self.scorematrix['L']['T'] = -1
    self.scorematrix['L']['N'] = -3
    self.scorematrix['L']['Q'] = -2
    self.scorematrix['L']['Y'] = -1
    self.scorematrix['L']['W'] = -2
    self.scorematrix['L']['P'] = -3
    self.scorematrix['L']['H'] = -3
    self.scorematrix['L']['M'] = 2
    self.scorematrix['L']['C'] = -1
    self.scorematrix['L']['X'] = -1
    self.scorematrix['V']['L'] = 1
    self.scorematrix['V']['V'] = 4
    self.scorematrix['V']['I'] = 3
    self.scorematrix['V']['F'] = -1
    self.scorematrix['V']['K'] = -2
    self.scorematrix['V']['R'] = -3
    self.scorematrix['V']['E'] = -2
    self.scorematrix['V']['D'] = -3
    self.scorematrix['V']['A'] = 0
    self.scorematrix['V']['G'] = -3
    self.scorematrix['V']['S'] = -2
    self.scorematrix['V']['T'] = 0
    self.scorematrix['V']['N'] = -3
    self.scorematrix['V']['Q'] = -2
    self.scorematrix['V']['Y'] = -1
    self.scorematrix['V']['W'] = -3
    self.scorematrix['V']['P'] = -2
    self.scorematrix['V']['H'] = -3
    self.scorematrix['V']['M'] = 1
    self.scorematrix['V']['C'] = -1
    self.scorematrix['V']['X'] = -1
    self.scorematrix['I']['L'] = 2
    self.scorematrix['I']['V'] = 3
    self.scorematrix['I']['I'] = 4
    self.scorematrix['I']['F'] = 0
    self.scorematrix['I']['K'] = -3
    self.scorematrix['I']['R'] = -3
    self.scorematrix['I']['E'] = -3
    self.scorematrix['I']['D'] = -3
    self.scorematrix['I']['A'] = -1
    self.scorematrix['I']['G'] = -4
    self.scorematrix['I']['S'] = -2
    self.scorematrix['I']['T'] = -1
    self.scorematrix['I']['N'] = -3
    self.scorematrix['I']['Q'] = -3
    self.scorematrix['I']['Y'] = -1
    self.scorematrix['I']['W'] = -3
    self.scorematrix['I']['P'] = -3
    self.scorematrix['I']['H'] = -3
    self.scorematrix['I']['M'] = 1
    self.scorematrix['I']['C'] = -1
    self.scorematrix['I']['X'] = -1
    self.scorematrix['F']['L'] = 0
    self.scorematrix['F']['V'] = -1
    self.scorematrix['F']['I'] = 0
    self.scorematrix['F']['F'] = 6
    self.scorematrix['F']['K'] = -3
    self.scorematrix['F']['R'] = -3
    self.scorematrix['F']['E'] = -3
    self.scorematrix['F']['D'] = -3
    self.scorematrix['F']['A'] = -2
    self.scorematrix['F']['G'] = -3
    self.scorematrix['F']['S'] = -2
    self.scorematrix['F']['T'] = -2
    self.scorematrix['F']['N'] = -3
    self.scorematrix['F']['Q'] = -3
    self.scorematrix['F']['Y'] = 3
    self.scorematrix['F']['W'] = 1
    self.scorematrix['F']['P'] = -4
    self.scorematrix['F']['H'] = -1
    self.scorematrix['F']['M'] = 0
    self.scorematrix['F']['C'] = -2
    self.scorematrix['F']['X'] = -1
    self.scorematrix['K']['L'] = -2
    self.scorematrix['K']['V'] = -2
    self.scorematrix['K']['I'] = -3
    self.scorematrix['K']['F'] = -3
    self.scorematrix['K']['K'] = 5
    self.scorematrix['K']['R'] = 2
    self.scorematrix['K']['E'] = 1
    self.scorematrix['K']['D'] = -1
    self.scorematrix['K']['A'] = -1
    self.scorematrix['K']['G'] = -2
    self.scorematrix['K']['S'] = 0
    self.scorematrix['K']['T'] = -1
    self.scorematrix['K']['N'] = 0
    self.scorematrix['K']['Q'] = 1
    self.scorematrix['K']['Y'] = -2
    self.scorematrix['K']['W'] = -3
    self.scorematrix['K']['P'] = -1
    self.scorematrix['K']['H'] = -1
    self.scorematrix['K']['M'] = -1
    self.scorematrix['K']['C'] = -3
    self.scorematrix['K']['X'] = -1
    self.scorematrix['R']['L'] = -2
    self.scorematrix['R']['V'] = -3
    self.scorematrix['R']['I'] = -3
    self.scorematrix['R']['F'] = -3
    self.scorematrix['R']['K'] = 2
    self.scorematrix['R']['R'] = 5
    self.scorematrix['R']['E'] = 0
    self.scorematrix['R']['D'] = -2
    self.scorematrix['R']['A'] = -1
    self.scorematrix['R']['G'] = -2
    self.scorematrix['R']['S'] = -1
    self.scorematrix['R']['T'] = -1
    self.scorematrix['R']['N'] = 0
    self.scorematrix['R']['Q'] = 1
    self.scorematrix['R']['Y'] = -2
    self.scorematrix['R']['W'] = -3
    self.scorematrix['R']['P'] = -2
    self.scorematrix['R']['H'] = 0
    self.scorematrix['R']['M'] = -1
    self.scorematrix['R']['C'] = -3
    self.scorematrix['R']['X'] = -1
    self.scorematrix['E']['L'] = -3
    self.scorematrix['E']['V'] = -2
    self.scorematrix['E']['I'] = -3
    self.scorematrix['E']['F'] = -3
    self.scorematrix['E']['K'] = 1
    self.scorematrix['E']['R'] = 0
    self.scorematrix['E']['E'] = 5
    self.scorematrix['E']['D'] = 2
    self.scorematrix['E']['A'] = -1
    self.scorematrix['E']['G'] = -2
    self.scorematrix['E']['S'] = 0
    self.scorematrix['E']['T'] = -1
    self.scorematrix['E']['N'] = 0
    self.scorematrix['E']['Q'] = 2
    self.scorematrix['E']['Y'] = -2
    self.scorematrix['E']['W'] = -3
    self.scorematrix['E']['P'] = -1
    self.scorematrix['E']['H'] = 0
    self.scorematrix['E']['M'] = -2
    self.scorematrix['E']['C'] = -4
    self.scorematrix['E']['X'] = -1
    self.scorematrix['D']['L'] = -4
    self.scorematrix['D']['V'] = -3
    self.scorematrix['D']['I'] = -3
    self.scorematrix['D']['F'] = -3
    self.scorematrix['D']['K'] = -1
    self.scorematrix['D']['R'] = -2
    self.scorematrix['D']['E'] = 2
    self.scorematrix['D']['D'] = 6
    self.scorematrix['D']['A'] = -2
    self.scorematrix['D']['G'] = -1
    self.scorematrix['D']['S'] = 0
    self.scorematrix['D']['T'] = -1
    self.scorematrix['D']['N'] = 1
    self.scorematrix['D']['Q'] = 0
    self.scorematrix['D']['Y'] = -3
    self.scorematrix['D']['W'] = -4
    self.scorematrix['D']['P'] = -1
    self.scorematrix['D']['H'] = -1
    self.scorematrix['D']['M'] = -3
    self.scorematrix['D']['C'] = -3
    self.scorematrix['D']['X'] = -1
    self.scorematrix['A']['L'] = -1
    self.scorematrix['A']['V'] = 0
    self.scorematrix['A']['I'] = -1
    self.scorematrix['A']['F'] = -2
    self.scorematrix['A']['K'] = -1
    self.scorematrix['A']['R'] = -1
    self.scorematrix['A']['E'] = -1
    self.scorematrix['A']['D'] = -2
    self.scorematrix['A']['A'] = 4
    self.scorematrix['A']['G'] = 0
    self.scorematrix['A']['S'] = 1
    self.scorematrix['A']['T'] = 0
    self.scorematrix['A']['N'] = -2
    self.scorematrix['A']['Q'] = -1
    self.scorematrix['A']['Y'] = -2
    self.scorematrix['A']['W'] = -3
    self.scorematrix['A']['P'] = -1
    self.scorematrix['A']['H'] = -2
    self.scorematrix['A']['M'] = -1
    self.scorematrix['A']['C'] = 0
    self.scorematrix['A']['X'] = 0
    self.scorematrix['G']['L'] = -4
    self.scorematrix['G']['V'] = -3
    self.scorematrix['G']['I'] = -4
    self.scorematrix['G']['F'] = -3
    self.scorematrix['G']['K'] = -2
    self.scorematrix['G']['R'] = -2
    self.scorematrix['G']['E'] = -2
    self.scorematrix['G']['D'] = -1
    self.scorematrix['G']['A'] = 0
    self.scorematrix['G']['G'] = 6
    self.scorematrix['G']['S'] = 0
    self.scorematrix['G']['T'] = -2
    self.scorematrix['G']['N'] = 0
    self.scorematrix['G']['Q'] = -2
    self.scorematrix['G']['Y'] = -3
    self.scorematrix['G']['W'] = -2
    self.scorematrix['G']['P'] = -2
    self.scorematrix['G']['H'] = -2
    self.scorematrix['G']['M'] = -3
    self.scorematrix['G']['C'] = -3
    self.scorematrix['G']['X'] = -1
    self.scorematrix['S']['L'] = -2
    self.scorematrix['S']['V'] = -2
    self.scorematrix['S']['I'] = -2
    self.scorematrix['S']['F'] = -2
    self.scorematrix['S']['K'] = 0
    self.scorematrix['S']['R'] = -1
    self.scorematrix['S']['E'] = 0
    self.scorematrix['S']['D'] = 0
    self.scorematrix['S']['A'] = 1
    self.scorematrix['S']['G'] = 0
    self.scorematrix['S']['S'] = 4
    self.scorematrix['S']['T'] = 1
    self.scorematrix['S']['N'] = 1
    self.scorematrix['S']['Q'] = 0
    self.scorematrix['S']['Y'] = -2
    self.scorematrix['S']['W'] = -3
    self.scorematrix['S']['P'] = -1
    self.scorematrix['S']['H'] = -1
    self.scorematrix['S']['M'] = -1
    self.scorematrix['S']['C'] = -1
    self.scorematrix['S']['X'] = 0
    self.scorematrix['T']['L'] = -1
    self.scorematrix['T']['V'] = 0
    self.scorematrix['T']['I'] = -1
    self.scorematrix['T']['F'] = -2
    self.scorematrix['T']['K'] = -1
    self.scorematrix['T']['R'] = -1
    self.scorematrix['T']['E'] = -1
    self.scorematrix['T']['D'] = -1
    self.scorematrix['T']['A'] = 0
    self.scorematrix['T']['G'] = -2
    self.scorematrix['T']['S'] = 1
    self.scorematrix['T']['T'] = 5
    self.scorematrix['T']['N'] = 0
    self.scorematrix['T']['Q'] = -1
    self.scorematrix['T']['Y'] = -2
    self.scorematrix['T']['W'] = -2
    self.scorematrix['T']['P'] = -1
    self.scorematrix['T']['H'] = -2
    self.scorematrix['T']['M'] = -1
    self.scorematrix['T']['C'] = -1
    self.scorematrix['T']['X'] = 0
    self.scorematrix['N']['L'] = -3
    self.scorematrix['N']['V'] = -3
    self.scorematrix['N']['I'] = -3
    self.scorematrix['N']['F'] = -3
    self.scorematrix['N']['K'] = 0
    self.scorematrix['N']['R'] = 0
    self.scorematrix['N']['E'] = 0
    self.scorematrix['N']['D'] = 1
    self.scorematrix['N']['A'] = -2
    self.scorematrix['N']['G'] = 0
    self.scorematrix['N']['S'] = 1
    self.scorematrix['N']['T'] = 0
    self.scorematrix['N']['N'] = 6
    self.scorematrix['N']['Q'] = 0
    self.scorematrix['N']['Y'] = -2
    self.scorematrix['N']['W'] = -4
    self.scorematrix['N']['P'] = -2
    self.scorematrix['N']['H'] = 1
    self.scorematrix['N']['M'] = -2
    self.scorematrix['N']['C'] = -3
    self.scorematrix['N']['X'] = -1
    self.scorematrix['Q']['L'] = -2
    self.scorematrix['Q']['V'] = -2
    self.scorematrix['Q']['I'] = -3
    self.scorematrix['Q']['F'] = -3
    self.scorematrix['Q']['K'] = 1
    self.scorematrix['Q']['R'] = 1
    self.scorematrix['Q']['E'] = 2
    self.scorematrix['Q']['D'] = 0
    self.scorematrix['Q']['A'] = -1
    self.scorematrix['Q']['G'] = -2
    self.scorematrix['Q']['S'] = 0
    self.scorematrix['Q']['T'] = -1
    self.scorematrix['Q']['N'] = 0
    self.scorematrix['Q']['Q'] = 5
    self.scorematrix['Q']['Y'] = -1
    self.scorematrix['Q']['W'] = -2
    self.scorematrix['Q']['P'] = -1
    self.scorematrix['Q']['H'] = 0
    self.scorematrix['Q']['M'] = 0
    self.scorematrix['Q']['C'] = -3
    self.scorematrix['Q']['X'] = -1
    self.scorematrix['Y']['L'] = -1
    self.scorematrix['Y']['V'] = -1
    self.scorematrix['Y']['I'] = -1
    self.scorematrix['Y']['F'] = 3
    self.scorematrix['Y']['K'] = -2
    self.scorematrix['Y']['R'] = -2
    self.scorematrix['Y']['E'] = -2
    self.scorematrix['Y']['D'] = -3
    self.scorematrix['Y']['A'] = -2
    self.scorematrix['Y']['G'] = -3
    self.scorematrix['Y']['S'] = -2
    self.scorematrix['Y']['T'] = -2
    self.scorematrix['Y']['N'] = -2
    self.scorematrix['Y']['Q'] = -1
    self.scorematrix['Y']['Y'] = 7
    self.scorematrix['Y']['W'] = 2
    self.scorematrix['Y']['P'] = -3
    self.scorematrix['Y']['H'] = 2
    self.scorematrix['Y']['M'] = -1
    self.scorematrix['Y']['C'] = -2
    self.scorematrix['Y']['X'] = -1
    self.scorematrix['W']['L'] = -2
    self.scorematrix['W']['V'] = -3
    self.scorematrix['W']['I'] = -3
    self.scorematrix['W']['F'] = 1
    self.scorematrix['W']['K'] = -3
    self.scorematrix['W']['R'] = -3
    self.scorematrix['W']['E'] = -3
    self.scorematrix['W']['D'] = -4
    self.scorematrix['W']['A'] = -3
    self.scorematrix['W']['G'] = -2
    self.scorematrix['W']['S'] = -3
    self.scorematrix['W']['T'] = -2
    self.scorematrix['W']['N'] = -4
    self.scorematrix['W']['Q'] = -2
    self.scorematrix['W']['Y'] = 2
    self.scorematrix['W']['W'] = 11
    self.scorematrix['W']['P'] = -4
    self.scorematrix['W']['H'] = -2
    self.scorematrix['W']['M'] = -1
    self.scorematrix['W']['C'] = -2
    self.scorematrix['W']['X'] = -2
    self.scorematrix['P']['L'] = -3
    self.scorematrix['P']['V'] = -2
    self.scorematrix['P']['I'] = -3
    self.scorematrix['P']['F'] = -4
    self.scorematrix['P']['K'] = -1
    self.scorematrix['P']['R'] = -2
    self.scorematrix['P']['E'] = -1
    self.scorematrix['P']['D'] = -1
    self.scorematrix['P']['A'] = -1
    self.scorematrix['P']['G'] = -2
    self.scorematrix['P']['S'] = -1
    self.scorematrix['P']['T'] = -1
    self.scorematrix['P']['N'] = -2
    self.scorematrix['P']['Q'] = -1
    self.scorematrix['P']['Y'] = -3
    self.scorematrix['P']['W'] = -4
    self.scorematrix['P']['P'] = 7
    self.scorematrix['P']['H'] = -2
    self.scorematrix['P']['M'] = -2
    self.scorematrix['P']['C'] = -3
    self.scorematrix['P']['X'] = -2
    self.scorematrix['H']['L'] = -3
    self.scorematrix['H']['V'] = -3
    self.scorematrix['H']['I'] = -3
    self.scorematrix['H']['F'] = -1
    self.scorematrix['H']['K'] = -1
    self.scorematrix['H']['R'] = 0
    self.scorematrix['H']['E'] = 0
    self.scorematrix['H']['D'] = -1
    self.scorematrix['H']['A'] = -2
    self.scorematrix['H']['G'] = -2
    self.scorematrix['H']['S'] = -1
    self.scorematrix['H']['T'] = -2
    self.scorematrix['H']['N'] = 1
    self.scorematrix['H']['Q'] = 0
    self.scorematrix['H']['Y'] = 2
    self.scorematrix['H']['W'] = -2
    self.scorematrix['H']['P'] = -2
    self.scorematrix['H']['H'] = 8
    self.scorematrix['H']['M'] = -2
    self.scorematrix['H']['C'] = -3
    self.scorematrix['H']['X'] = -1
    self.scorematrix['M']['L'] = 2
    self.scorematrix['M']['V'] = 1
    self.scorematrix['M']['I'] = 1
    self.scorematrix['M']['F'] = 0
    self.scorematrix['M']['K'] = -1
    self.scorematrix['M']['R'] = -1
    self.scorematrix['M']['E'] = -2
    self.scorematrix['M']['D'] = -3
    self.scorematrix['M']['A'] = -1
    self.scorematrix['M']['G'] = -3
    self.scorematrix['M']['S'] = -1
    self.scorematrix['M']['T'] = -1
    self.scorematrix['M']['N'] = -2
    self.scorematrix['M']['Q'] = 0
    self.scorematrix['M']['Y'] = -1
    self.scorematrix['M']['W'] = -1
    self.scorematrix['M']['P'] = -2
    self.scorematrix['M']['H'] = -2
    self.scorematrix['M']['M'] = 5
    self.scorematrix['M']['C'] = -1
    self.scorematrix['M']['X'] = -1
    self.scorematrix['C']['L'] = -1
    self.scorematrix['C']['V'] = -1
    self.scorematrix['C']['I'] = -1
    self.scorematrix['C']['F'] = -2
    self.scorematrix['C']['K'] = -3
    self.scorematrix['C']['R'] = -3
    self.scorematrix['C']['E'] = -4
    self.scorematrix['C']['D'] = -3
    self.scorematrix['C']['A'] = 0
    self.scorematrix['C']['G'] = -3
    self.scorematrix['C']['S'] = -1
    self.scorematrix['C']['T'] = -1
    self.scorematrix['C']['N'] = -3
    self.scorematrix['C']['Q'] = -3
    self.scorematrix['C']['Y'] = -2
    self.scorematrix['C']['W'] = -2
    self.scorematrix['C']['P'] = -3
    self.scorematrix['C']['H'] = -3
    self.scorematrix['C']['M'] = -1
    self.scorematrix['C']['C'] = 9
    self.scorematrix['C']['X'] = -2
    self.scorematrix['X']['L'] = -1
    self.scorematrix['X']['V'] = -1
    self.scorematrix['X']['I'] = -1
    self.scorematrix['X']['F'] = -1
    self.scorematrix['X']['K'] = -1
    self.scorematrix['X']['R'] = -1
    self.scorematrix['X']['E'] = -1
    self.scorematrix['X']['D'] = -1
    self.scorematrix['X']['A'] = 0
    self.scorematrix['X']['G'] = -1
    self.scorematrix['X']['S'] = 0
    self.scorematrix['X']['T'] = 0
    self.scorematrix['X']['N'] = -1
    self.scorematrix['X']['Q'] = -1
    self.scorematrix['X']['Y'] = -1
    self.scorematrix['X']['W'] = -2
    self.scorematrix['X']['P'] = -2
    self.scorematrix['X']['H'] = -1
    self.scorematrix['X']['M'] = -1
    self.scorematrix['X']['C'] = -2
    self.scorematrix['X']['X'] = -1

  def getscorerow(self,x):
    return self.scorematrix[x]

  def getscore(self, x, y):
    if (x in self.scorematrix) and (y in self.scorematrix[x]):
      return self.scorematrix[x][y]
    else:
      print("Invalid character pair {},{}".format(x,y))
      exit(1)

  def orderscore_get(self):
    orderscore = dict()
    for cc in self.alpha:
      # sort in descending order of score values of the characters replacing
      # cc
      orderscore[cc] = sorted(self.scorematrix[cc].items(),
                              key=operator.itemgetter(1))
    return orderscore

  def isunitscorematrix(self):
    return False
